<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Dragon Ball ¬∑ Archivo Vivo OMNI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
 --bg: #05050b;
 --glass: rgba(20, 20, 35, 0.7);
 --border: rgba(255, 255, 255, 0.1);
 --gold: #ffd166;
 --red: #ff4757;
 --blue: #2ed573;
 --neon: #00d2d3;
 --purple: #5f27cd;
 --font-main: 'Segoe UI', system-ui, sans-serif;
}

*{box-sizing:border-box;margin:0;padding:0}

body{
 background: var(--bg);
 color: #fff;
 font-family: var(--font-main);
 overflow-x: hidden;
 min-height: 100vh;
}

/* --- FONDO ANIMADO --- */
.bg-grid{
 position: fixed; inset: 0; z-index: -1;
 background: 
  linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
  linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
 background-size: 40px 40px;
 animation: gridScroll 20s linear infinite;
 perspective: 1000px;
}
.bg-overlay{
 position: fixed; inset: 0; z-index: -1;
 background: radial-gradient(circle at 50% 50%, rgba(255,209,102,0.05), transparent 80%);
}
@keyframes gridScroll{
 0%{transform: translateY(0)}
 100%{transform: translateY(40px)}
}

/* --- HEADER HUD --- */
header{
 padding: clamp(2rem, 5vw, 4rem) 1.5rem;
 text-align: center;
 position: relative;
}
.title{
 font-size: clamp(3rem, 10vw, 5rem);
 font-weight: 900;
 text-transform: uppercase;
 background: linear-gradient(to bottom, #fff, #aaa);
 -webkit-background-clip: text;
 color: transparent;
 letter-spacing: -2px;
 text-shadow: 0 10px 30px rgba(0,0,0,0.5);
 position: relative;
 display: inline-block;
}
.title::after{
 content: 'MULTIVERSE';
 position: absolute;
 bottom: -10px;
 right: 0;
 font-size: 1rem;
 letter-spacing: 0.5em;
 color: var(--gold);
 -webkit-text-fill-color: var(--gold);
}
.stats-bar{
 display: flex;
 justify-content: center;
 gap: 1rem;
 margin-top: 2rem;
 flex-wrap: wrap;
}
.stat-pill{
 background: var(--glass);
 border: 1px solid var(--border);
 padding: 0.5rem 1rem;
 border-radius: 50px;
 font-size: 0.8rem;
 backdrop-filter: blur(10px);
 display: flex;
 align-items: center;
 gap: 0.5rem;
}
.stat-pill span{ color: var(--gold); font-weight: bold; }

/* --- CONTROLES --- */
.controls{
 padding: 0 1.5rem;
 max-width: 1200px;
 margin: 0 auto 2rem;
 display: grid;
 grid-template-columns: 1fr auto;
 gap: 1rem;
}
input, select{
 background: var(--glass);
 border: 1px solid var(--border);
 padding: 1rem;
 border-radius: 12px;
 color: #fff;
 font-family: inherit;
 outline: none;
 transition: 0.3s;
}
input:focus, select:focus{
 border-color: var(--gold);
 box-shadow: 0 0 15px rgba(255,209,102,0.2);
}
@media(max-width: 600px){ .controls{ grid-template-columns: 1fr; } }

/* --- SECCIONES --- */
.section{
 padding: 2rem 0;
 max-width: 1400px;
 margin: 0 auto;
}
.section-title{
 padding-left: 1.5rem;
 margin-bottom: 1.5rem;
 font-size: 0.9rem;
 letter-spacing: 0.3em;
 text-transform: uppercase;
 color: var(--neon);
 display: flex;
 align-items: center;
 gap: 1rem;
}
.section-title::after{
 content:''; height: 1px; flex: 1;
 background: linear-gradient(90deg, var(--border), transparent);
}

/* --- TARJETAS --- */
.scroll-track{
 display: flex;
 gap: 1.5rem;
 overflow-x: auto;
 padding: 1rem 1.5rem 2rem;
 scroll-snap-type: x mandatory;
}
.card{
 min-width: 280px;
 height: 180px;
 border-radius: 20px;
 background: #000;
 position: relative;
 overflow: hidden;
 scroll-snap-align: center;
 border: 1px solid var(--border);
 transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
 cursor: pointer;
}
.card:hover{
 transform: scale(1.05) translateY(-5px);
 box-shadow: 0 15px 30px rgba(0,0,0,0.5);
 border-color: var(--gold);
}
.card video, .card img{
 width: 100%; height: 100%; object-fit: cover;
 opacity: 0.6; transition: 0.4s;
}
.card:hover video, .card:hover img{ opacity: 1; }
.card-info{
 position: absolute;
 bottom: 0; left: 0; right: 0;
 padding: 1rem;
 background: linear-gradient(transparent, rgba(0,0,0,0.9));
}
.card-name{ font-weight: 800; font-size: 1.1rem; }
.card-tag{ 
 font-size: 0.7rem; 
 text-transform: uppercase; 
 letter-spacing: 0.1em; 
 color: var(--gold);
}

/* --- PERSONAJES CIRCULARES --- */
.chars-grid{
 display: flex; gap: 1.5rem; padding: 1rem 1.5rem; overflow-x: auto;
}
.char-circle{
 min-width: 100px; height: 100px;
 border-radius: 50%;
 border: 2px solid var(--border);
 position: relative;
 cursor: pointer;
 transition: 0.3s;
}
.char-circle img{
 width: 100%; height: 100%; border-radius: 50%; object-fit: cover;
}
.char-circle:hover{
 transform: scale(1.15);
 border-color: var(--neon);
 box-shadow: 0 0 20px var(--neon);
}
.char-badge{
 position: absolute; bottom: -5px; right: -5px;
 background: var(--bg); border: 1px solid var(--gold);
 color: var(--gold); font-size: 0.6rem; padding: 2px 6px;
 border-radius: 10px; font-weight: bold;
}

/* --- √ÅRBOL DE DATOS --- */
.tree-container{
 margin: 0 1.5rem;
 background: var(--glass);
 border-radius: 20px;
 padding: 2rem;
 border: 1px solid var(--border);
}
.node{
 margin-bottom: 0.5rem;
}
.node-header{
 cursor: pointer;
 padding: 0.8rem;
 border-radius: 8px;
 display: flex; justify-content: space-between;
 background: rgba(255,255,255,0.03);
 transition: 0.3s;
}
.node-header:hover{ background: rgba(255,255,255,0.08); color: var(--gold); }
.node-content{
 max-height: 0; overflow: hidden; transition: 0.5s ease;
 padding-left: 1rem; border-left: 2px solid var(--border);
 margin-left: 1rem;
}
.node.active .node-content{ max-height: 500px; margin-top: 1rem; }
.node.active .node-header{ background: linear-gradient(90deg, rgba(255,209,102,0.1), transparent); border-left: 3px solid var(--gold); }

/* --- NARRADOR Y EFECTOS --- */
#narrator{
 position: fixed; bottom: 0; left: 0; right: 0;
 background: rgba(0,0,0,0.95);
 border-top: 2px solid var(--gold);
 padding: 1.5rem;
 z-index: 100;
 transform: translateY(100%);
 transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
 display: flex; gap: 1rem; align-items: center;
}
#narrator.visible{ transform: translateY(0); }
.narrator-icon{ font-size: 2rem; animation: pulse 2s infinite; }
.narrator-text{ font-family: monospace; color: var(--gold); line-height: 1.4; }

/* --- CORRUPCI√ìN --- */
body.corrupt{
 animation: glitch-anim 0.2s infinite;
 filter: contrast(1.5) saturate(2) hue-rotate(90deg);
}
body.corrupt .bg-grid{ background-image: linear-gradient(red 1px, transparent 1px); }

@keyframes glitch-anim{
 0%{transform: translate(0)}
 20%{transform: translate(-3px, 3px)}
 40%{transform: translate(-3px, -3px)}
 60%{transform: translate(3px, 3px)}
 80%{transform: translate(3px, -3px)}
 100%{transform: translate(0)}
}

@keyframes pulse{ 50%{ opacity: 0.5; transform: scale(0.9); } }
.hidden{ display: none !important; }
</style>
</head>

<body>

<div class="bg-grid"></div>
<div class="bg-overlay"></div>

<header>
 <div class="title">DRAGON BALL</div>
 <div class="stats-bar">
  <div class="stat-pill"><span>üì°</span> ESTADO: CONECTADO</div>
  <div class="stat-pill"><span id="count-display">0</span> REGISTROS</div>
  <div class="stat-pill"><span>‚ö†Ô∏è</span> NIVEL DE AMENAZA: OMEGA</div>
 </div>
</header>

<div class="controls">
 <input type="text" id="searchInput" placeholder="üîç Buscar datos, transformaciones o t√©cnicas...">
 <select id="universeFilter">
  <option value="all">üåå Todos los Universos</option>
  <option value="Z">‚ö° Dragon Ball Z</option>
  <option value="SUPER">üî• Dragon Ball Super</option>
  <option value="GT">‚öôÔ∏è Dragon Ball GT</option>
  <option value="MANGA">üìñ Manga (Canon)</option>
 </select>
</div>

<div class="section">
 <div class="section-title">Visualizaci√≥n de Archivo</div>
 <div class="scroll-track" id="mediaContainer"></div>
</div>

<div class="section">
 <div class="section-title">Entidades Registradas</div>
 <div class="chars-grid" id="charContainer"></div>
</div>

<div class="section">
 <div class="section-title">√Årbol de Datos Estructural</div>
 <div class="tree-container" id="treeContainer"></div>
</div>

<div id="narrator">
 <div class="narrator-icon">üëÅÔ∏è</div>
 <div class="narrator-text" id="narratorText">Esperando input del usuario...</div>
</div>

<audio id="sfx-glitch" src="https://assets.mixkit.co/sfx/preview/mixkit-tv-static-1003.mp3"></audio>
<audio id="sfx-hover" src="https://assets.mixkit.co/sfx/preview/mixkit-sci-fi-click-900.mp3"></audio>

<script>
// ==========================================
// BASE DE DATOS MAESTRA (MERGED)
// ==========================================
const DATABASE = [
 {
  id: "Goku",
  name: "Son Goku",
  universe: "SUPER",
  tags: ["Saiyajin", "Dios", "Ultra Instinto"],
  power: "Ultra Instinto Dominado",
  lore: "El mortal que alcanz√≥ el dominio de los √°ngeles. Su evoluci√≥n constante desaf√≠a la l√≥gica de los dioses.",
  avatar: "https://static.wikia.nocookie.net/dragonball/images/8/8a/Goku_UI.png",
  media: "https://cdn.coverr.co/videos/coverr-energy-burst-1534/1080p.mp4",
  fallback: "https://media.giphy.com/media/12KDixncjK6l7G/giphy.gif"
 },
 {
  id: "Vegeta",
  name: "Vegeta IV",
  universe: "SUPER",
  tags: ["Saiyajin", "Pr√≠ncipe", "Destrucci√≥n"],
  power: "Ultra Ego (Hakai)",
  lore: "El poder nacido de la destrucci√≥n. Vegeta ha aceptado su naturaleza para convertir el da√±o recibido en combustible de batalla.",
  avatar: "https://static.wikia.nocookie.net/dragonball/images/1/19/Vegeta_Super.png",
  media: "https://cdn.coverr.co/videos/coverr-purple-energy-explosion-9266/1080p.mp4",
  fallback: "https://media.giphy.com/media/l0HlG6dGZt2kqk1nG/giphy.gif"
 },
 {
  id: "Gohan",
  name: "Son Gohan",
  universe: "SUPER",
  tags: ["H√≠brido", "Bestia", "Potencial"],
  power: "Gohan Beast",
  lore: "La ira despert√≥ al demonio interno. Gohan Beast es la manifestaci√≥n f√≠sica de un potencial infinito finalmente desatado.",
  avatar: "https://i.imgur.com/vX9KqLm.png",
  media: "https://cdn.coverr.co/videos/coverr-lightning-bolt-strike-1080-7337/1080p.mp4",
  fallback: "https://media.giphy.com/media/26FxGPtjnVeS6qiJ2/giphy.gif"
 },
 {
  id: "Moro",
  name: "Moro el Devorador",
  universe: "MANGA",
  tags: ["Magia", "Villano", "Prisionero"],
  power: "Magia de Absorci√≥n Planetaria",
  lore: "Un hechicero ancestral que consume la vida de planetas enteros. Su magia puso de rodillas a Goku y Vegeta simult√°neamente.",
  avatar: "https://static.wikia.nocookie.net/dragonball/images/2/2e/Moro.png",
  media: "video_fail_test.mp4", // Test fallback
  fallback: "https://media.giphy.com/media/GRSnxyhJnPsaQy9YLn/giphy.gif"
 },
 {
  id: "Granolah",
  name: "Granolah",
  universe: "MANGA",
  tags: ["Cerealiano", "Sniper", "Deseo"],
  power: "Ojo Derecho Evolucionado",
  lore: "El superviviente. Sacrific√≥ 150 a√±os de vida a cambio de convertirse en el guerrero m√°s fuerte del universo por un instante.",
  avatar: "https://static.wikia.nocookie.net/dragonball/images/5/5c/Granolah.png",
  media: "video_fail_test2.mp4",
  fallback: "https://media.giphy.com/media/12KDixncjK6l7G/giphy.gif"
 },
 {
  id: "Broly",
  name: "Broly",
  universe: "SUPER",
  tags: ["Mutante", "Legendario", "Ira"],
  power: "Super Saiyajin Legendario (Full Power)",
  lore: "Una fuerza de la naturaleza. Su poder aumenta con cada segundo de combate, perdiendo la raz√≥n en el proceso.",
  avatar: "https://i.imgur.com/P5x5v8B.png", 
  media: "https://cdn.coverr.co/videos/coverr-green-toxic-energy-9260/1080p.mp4",
  fallback: "https://media.giphy.com/media/v6vFygoX4j5de/giphy.gif"
 },
 {
  id: "GokuBlack",
  name: "Goku Black",
  universe: "SUPER",
  tags: ["Kaioshin", "Dios", "Ros√©"],
  power: "Super Saiyajin Ros√©",
  lore: "La belleza de la destrucci√≥n divina. Zamasu en el cuerpo de Goku alcanz√≥ una forma que supera el entendimiento mortal.",
  avatar: "https://static.wikia.nocookie.net/dragonball/images/0/0f/Goku_Black.png",
  media: "https://cdn.coverr.co/videos/coverr-cosmic-purple-energy-9261/1080p.mp4",
  fallback: "https://media.giphy.com/media/l0MYC0LajbaPoEADu/giphy.gif"
 },
 {
  id: "GokuGT",
  name: "Goku (GT)",
  universe: "GT",
  tags: ["SSJ4", "Ozaru", "No Canon"],
  power: "Super Saiyajin 4",
  lore: "‚ö†Ô∏è ERROR DE L√çNEA TEMPORAL. Una evoluci√≥n primitiva que conecta el poder Saiyajin con sus ra√≠ces Ozaru.",
  avatar: "https://static.wikia.nocookie.net/dragonball/images/6/6a/Goku_GT_SSJ4.png",
  media: "video_fail_test3.mp4",
  fallback: "https://media.giphy.com/media/3o6ZtpxSZbQRRnwCKQ/giphy.gif"
 }
];

// ==========================================
// SISTEMA L√ìGICO
// ==========================================

const DOM = {
 media: document.getElementById('mediaContainer'),
 chars: document.getElementById('charContainer'),
 tree: document.getElementById('treeContainer'),
 search: document.getElementById('searchInput'),
 filter: document.getElementById('universeFilter'),
 narrator: document.getElementById('narrator'),
 txt: document.getElementById('narratorText'),
 sfxGlitch: document.getElementById('sfx-glitch'),
 sfxHover: document.getElementById('sfx-hover'),
 counter: document.getElementById('count-display')
};

let currentUniverse = null;
let narratorTimeout = null;

// INIT
function init(){
 DOM.counter.textContent = DATABASE.length;
 renderAll(DATABASE);
 DOM.search.addEventListener('input', handleSearch);
 DOM.filter.addEventListener('change', handleSearch);
 
 // Hover SFX logic
 document.body.addEventListener('mouseover', (e) => {
  if(e.target.closest('.card') || e.target.closest('.char-circle') || e.target.closest('.node-header')){
   playHover();
  }
 });
}

// RENDERIZADO
function renderAll(data){
 DOM.media.innerHTML = '';
 DOM.chars.innerHTML = '';
 DOM.tree.innerHTML = '';

 data.forEach(entry => {
  // 1. Tarjeta Media
  const card = document.createElement('div');
  card.className = 'card';
  card.onclick = () => activateEntry(entry);
  
  // Video con fallback inteligente
  const mediaEl = document.createElement('video');
  mediaEl.src = entry.media;
  mediaEl.muted = true; mediaEl.loop = true; mediaEl.playsInline = true;
  mediaEl.onmouseover = () => mediaEl.play().catch(()=>{});
  mediaEl.onmouseout = () => mediaEl.pause();
  mediaEl.onerror = () => {
   // Si falla el video, reemplazamos por imagen
   const img = document.createElement('img');
   img.src = entry.fallback || entry.avatar;
   card.replaceChild(img, mediaEl);
  };
  
  card.innerHTML = `
   <div class="card-info">
    <div class="card-name">${entry.name}</div>
    <div class="card-tag">${entry.universe}</div>
   </div>
  `;
  card.prepend(mediaEl);
  DOM.media.appendChild(card);

  // 2. C√≠rculo Personaje
  const char = document.createElement('div');
  char.className = 'char-circle';
  char.onclick = () => activateEntry(entry);
  char.innerHTML = `
   <img src="${entry.avatar}">
   <span class="char-badge">${entry.universe}</span>
  `;
  DOM.chars.appendChild(char);

  // 3. Nodo √Årbol
  const node = document.createElement('div');
  node.className = 'node';
  node.innerHTML = `
   <div class="node-header" onclick="toggleNode(this)">
    <span>${entry.name}</span>
    <span style="color:var(--gold); opacity:0.6">${entry.power}</span>
   </div>
   <div class="node-content">
    <p>${entry.lore}</p>
    <small style="color:var(--neon)">TAGS: ${entry.tags.join(' // ')}</small>
   </div>
  `;
  DOM.tree.appendChild(node);
 });
}

// L√ìGICA DE INTERACCI√ìN
function activateEntry(entry){
 // Efecto Corrupci√≥n si cambia de universo
 if(currentUniverse && currentUniverse !== entry.universe){
  triggerCorruption();
 }
 currentUniverse = entry.universe;

 // Narrador
 speak(entry.lore);

 // Highlight en √°rbol (simple)
 const nodes = document.querySelectorAll('.node-header');
 nodes.forEach(n => {
  if(n.innerText.includes(entry.name)){
   n.click();
   n.scrollIntoView({behavior:'smooth', block:'center'});
  }
 });
}

function toggleNode(header){
 const node = header.parentElement;
 const wasActive = node.classList.contains('active');
 
 // Cierra todos
 document.querySelectorAll('.node').forEach(n => n.classList.remove('active'));
 
 if(!wasActive) node.classList.add('active');
}

function handleSearch(){
 const q = DOM.search.value.toLowerCase();
 const filter = DOM.filter.value;

 const filtered = DATABASE.filter(item => {
  const matchText = item.name.toLowerCase().includes(q) || 
                    item.lore.toLowerCase().includes(q) ||
                    item.tags.some(t => t.toLowerCase().includes(q));
  const matchUni = filter === 'all' || item.universe === filter;
  return matchText && matchUni;
 });

 renderAll(filtered);
}

// EFECTOS ESPECIALES
function triggerCorruption(){
 document.body.classList.add('corrupt');
 DOM.sfxGlitch.currentTime = 0;
 DOM.sfxGlitch.volume = 0.3;
 DOM.sfxGlitch.play().catch(()=>{});
 speak("‚ö†Ô∏è ALERTA: INESTABILIDAD DIMENSIONAL DETECTADA. CAMBIANDO DE UNIVERSO...");
 
 setTimeout(() => {
  document.body.classList.remove('corrupt');
  DOM.sfxGlitch.pause();
 }, 1500);
}

function speak(text){
 DOM.narrator.classList.add('visible');
 DOM.txt.textContent = '';
 clearTimeout(narratorTimeout);
 
 let i = 0;
 function type(){
  if(i < text.length){
   DOM.txt.textContent += text.charAt(i);
   i++;
   setTimeout(type, 20);
  }
 }
 type();

 narratorTimeout = setTimeout(() => {
  DOM.narrator.classList.remove('visible');
 }, 6000); // Se oculta despu√©s de 6s
}

function playHover(){
 DOM.sfxHover.volume = 0.1;
 DOM.sfxHover.currentTime = 0;
 DOM.sfxHover.play().catch(()=>{});
}

// INICIAR
window.addEventListener('DOMContentLoaded', init);

// EASTER EGG (Doble Click para corromper manualmente)
document.addEventListener('dblclick', triggerCorruption);

</script>
</body>
</html>
